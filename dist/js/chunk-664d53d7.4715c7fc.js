(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-664d53d7"],{"1f27":function(e,t,a){"use strict";var r=a("9efd"),o="/api/admin/menus",n={listAll:function(){return Object(r["a"])({url:o,method:"get"})},listTree:function(){return Object(r["a"])({url:"".concat(o,"/tree_view"),method:"get"})},create:function(e){return Object(r["a"])({url:o,data:e,method:"post"})},delete:function(e){return Object(r["a"])({url:"".concat(o,"/").concat(e),method:"delete"})},get:function(e){return Object(r["a"])({url:"".concat(o,"/").concat(e),method:"get"})},update:function(e,t){return Object(r["a"])({url:"".concat(o,"/").concat(e),data:t,method:"put"})},listTeams:function(){return Object(r["a"])({url:"".concat(o,"/teams"),method:"get"})}};t["a"]=n},"71d6":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-view",[a("a-row",{attrs:{gutter:12}},[a("a-col",{staticClass:"mb-3",attrs:{xl:10,lg:10,md:10,sm:24,xs:24}},[a("a-card",{attrs:{title:e.title,bodyStyle:{padding:"16px"}}},[a("a-form-model",{ref:"menuForm",attrs:{model:e.form.model,rules:e.form.rules,layout:"horizontal"}},[a("a-form-model-item",{attrs:{label:"名称：",help:"* 页面上所显示的名称",prop:"name"}},[a("a-input",{model:{value:e.form.model.name,callback:function(t){e.$set(e.form.model,"name",t)},expression:"form.model.name"}})],1),a("a-form-model-item",{attrs:{label:"地址：",help:"* 菜单的地址",prop:"url"}},[a("a-input",{model:{value:e.form.model.url,callback:function(t){e.$set(e.form.model,"url",t)},expression:"form.model.url"}})],1),a("a-form-model-item",{attrs:{label:"上级菜单：",prop:"parentId"}},[a("menu-select-tree",{attrs:{menus:e.table.data},model:{value:e.form.model.parentId,callback:function(t){e.$set(e.form.model,"parentId",t)},expression:"form.model.parentId"}})],1),a("a-form-model-item",{attrs:{label:"排序编号：",prop:"priority"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:e.form.model.priority,callback:function(t){e.$set(e.form.model,"priority",t)},expression:"form.model.priority"}})],1),a("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.form.moreField,expression:"form.moreField"}],attrs:{label:"图标：",help:"* 请根据主题的支持选填",prop:"icon"}},[a("a-input",{model:{value:e.form.model.icon,callback:function(t){e.$set(e.form.model,"icon",t)},expression:"form.model.icon"}})],1),a("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.form.moreField,expression:"form.moreField"}],attrs:{label:"分组：",prop:"team"}},[a("a-auto-complete",{attrs:{dataSource:e.teams.data,allowClear:""},model:{value:e.form.model.team,callback:function(t){e.$set(e.form.model,"team",t)},expression:"form.model.team"}})],1),a("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.form.moreField,expression:"form.moreField"}],attrs:{label:"打开方式：",prop:"target"}},[a("a-select",{attrs:{defaultValue:"_self"},model:{value:e.form.model.target,callback:function(t){e.$set(e.form.model,"target",t)},expression:"form.model.target"}},[a("a-select-option",{attrs:{value:"_self"}},[e._v("当前窗口")]),a("a-select-option",{attrs:{value:"_blank"}},[e._v("新窗口")])],1)],1),a("a-form-model-item",[e.isUpdateMode?a("a-button-group",[a("ReactiveButton",{attrs:{type:"primary",loading:e.form.saving,errored:e.form.errored,text:"更新",loadedText:"更新成功",erroredText:"更新失败"},on:{click:e.handleCreateOrUpdateMenu,callback:e.handleSavedCallback}}),e.isUpdateMode?a("a-button",{attrs:{type:"dashed"},on:{click:function(t){e.form.model={}}}},[e._v("返回添加")]):e._e()],1):a("ReactiveButton",{attrs:{type:"primary",loading:e.form.saving,errored:e.form.errored,text:"保存",loadedText:"保存成功",erroredText:"保存失败"},on:{click:e.handleCreateOrUpdateMenu,callback:e.handleSavedCallback}}),a("a",{staticClass:"ml-2",on:{click:function(t){e.form.moreField=!e.form.moreField}}},[e._v(" 更多选项 "),a("a-icon",{attrs:{type:e.form.moreField?"up":"down"}})],1)],1)],1)],1)],1),a("a-col",{staticClass:"pb-3",attrs:{xl:14,lg:14,md:14,sm:24,xs:24}},[a("a-card",{attrs:{title:"所有菜单",bodyStyle:{padding:"16px"}}},[e.isMobile()?a("a-list",{attrs:{itemLayout:"vertical",size:"large",pagination:!1,dataSource:e.table.data,loading:e.table.loading},scopedSlots:e._u([{key:"renderItem",fn:function(t,r){return a("a-list-item",{key:r},[a("template",{slot:"actions"},[a("a-dropdown",{attrs:{placement:"topLeft",trigger:["click"]}},[a("span",[a("a-icon",{attrs:{type:"bars"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.form.model=t}}},[e._v("编辑")])]),a("a-menu-item",[a("a-popconfirm",{attrs:{title:"你确定要删除【"+t.name+"】菜单？",okText:"确定",cancelText:"取消"},on:{confirm:function(a){return e.handleDeleteMenu(t.id)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("删除")])])],1)],1)],1)],1),a("template",{slot:"extra"},[a("span",[e._v(" "+e._s(t.team)+" ")])]),a("a-list-item-meta",[a("template",{slot:"description"},[e._v(" "+e._s(t.url)+" ")]),a("span",{staticStyle:{"max-width":"300px",display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(t.name)+" ")])],2)],2)}}],null,!1,761880509)}):a("a-table",{attrs:{columns:e.table.columns,dataSource:e.table.data,loading:e.table.loading,rowKey:function(e){return e.id},scrollToFirstRowOnChange:!0},scopedSlots:e._u([{key:"action",fn:function(t,r){return a("span",{},[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.form.model=r}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"你确定要删除【"+r.name+"】菜单？",okText:"确定",cancelText:"取消"},on:{confirm:function(t){return e.handleDeleteMenu(r.id)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("删除")])])],1)}}])})],1)],1)],1)],1)},o=[],n=a("ac0d"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-tree-select",{attrs:{treeData:e.menuTreeData,placeholder:"请选择上级菜单，默认为顶级菜单",treeDefaultExpandAll:"",treeDataSimpleMode:!0,allowClear:!0,value:e.menuIdString},on:{change:e.handleSelectionChange}})},i=[],s=(a("6b54"),a("7f7f"),a("c5f6"),{name:"MenuSelectTree",model:{prop:"menuId",event:"change"},props:{menuId:{type:Number,required:!0,default:0},menus:{type:Array,required:!1,default:function(){return[]}}},computed:{menuTreeData:function(){return this.menus.map((function(e){return{id:e.id,title:e.name,value:e.id.toString(),pId:e.parentId}}))},menuIdString:function(){return this.menuId.toString()}},methods:{handleSelectionChange:function(e,t,a){this.$log.debug("value: ",e),this.$log.debug("label: ",t),this.$log.debug("extra: ",a),this.$emit("change",e?parseInt(e):0)}}}),m=s,d=a("2877"),c=Object(d["a"])(m,l,i,!1,null,null,null),u=c.exports,f=a("680a"),p=a("1f27"),h=[{title:"名称",dataIndex:"name",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"地址",ellipsis:!0,dataIndex:"url"},{title:"分组",ellipsis:!0,dataIndex:"team"},{title:"排序",dataIndex:"priority"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],g={components:{MenuSelectTree:u,PageView:f["c"]},mixins:[n["a"],n["b"]],data:function(){return{table:{columns:h,data:[],loading:!1},form:{model:{target:"_self"},saving:!1,errored:!1,rules:{name:[{required:!0,message:"* 菜单名称不能为空",trigger:["change"]},{max:50,message:"* 菜单名称的字符长度不能超过 50",trigger:["change"]}],url:[{required:!0,message:"* 菜单地址不能为空",trigger:["change"]},{max:1023,message:"* 菜单地址的字符长度不能超过 1023",trigger:["change"]}],icon:[{max:50,message:"* 菜单图标的字符长度不能超过 50",trigger:["change"]}],team:[{max:255,message:"* 菜单分组的字符长度不能超过 255",trigger:["change"]}]},moreField:!1},teams:{data:[]}}},computed:{title:function(){return this.isUpdateMode?"修改菜单":"添加菜单"},isUpdateMode:function(){return!!this.form.model.id}},created:function(){this.handleListMenus(),this.handleListTeams()},methods:{handleListMenus:function(){var e=this;this.table.loading=!0,p["a"].listTree().then((function(t){e.table.data=t.data.data})).finally((function(){setTimeout((function(){e.table.loading=!1}),200)}))},handleListTeams:function(){var e=this;p["a"].listTeams().then((function(t){e.teams.data=t.data.data}))},handleDeleteMenu:function(e){var t=this;p["a"].delete(e).then((function(e){t.$message.success("删除成功！")})).finally((function(){t.handleListMenus(),t.handleListTeams()}))},handleCreateOrUpdateMenu:function(){var e=this;e.$refs.menuForm.validate((function(t){t&&(e.form.saving=!0,e.isUpdateMode?p["a"].update(e.form.model.id,e.form.model).catch((function(){e.form.errored=!0})).finally((function(){setTimeout((function(){e.form.saving=!1}),400)})):p["a"].create(e.form.model).catch((function(){e.form.errored=!0})).finally((function(){setTimeout((function(){e.form.saving=!1}),400)})))}))},handleSavedCallback:function(){var e=this;e.form.errored?e.form.errored=!1:(e.form.model={target:"_self"},e.handleListMenus(),e.handleListTeams())}}},v=g,b=Object(d["a"])(v,r,o,!1,null,null,null);t["default"]=b.exports}}]);